<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Finance Unit เวร พ.สมทบ</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../dist/css/sweetalert2.min.css">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: eNno - v4.7.0
  * Template URL: https://bootstrapmade.com/enno-free-simple-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
<div id="app" v-cloak>
  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <h1 class="logo"><a href="./index.html">เบิกค่าเวร ที่ปรึกษากฎหมาย</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto active" href="#main">Home</a></li>          
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->

  <main id="main">
    <section id="ven_mouth" class="services section-bg"></section>
      <ul class="nav justify-content-center pt-3">
            <li class="nav-item">
                <!-- <a class="nav-link active" aria-current="page" href="#">Active</a> -->
            </li>
            <li class="nav-item">
                <!-- {{month}}{{year}} -->
                    <select class="form-select" name="month" id="month" v-model="month">
                        <option value="01">มกราคม</option>
                        <option value="02">กุมภาพันธ์</option>
                        <option value="03">มีนาคม</option>
                        <option value="04">เมษายน</option>
                        <option value="05">พฤษภาคม</option>
                        <option value="06">มิถุนายน</option>
                        <option value="07">กรกฎาคม</option>
                        <option value="08">สิงหาคม</option>
                        <option value="09">กันยายน</option>
                        <option value="10">ตุลาคม</option>
                        <option value="11">พฤศจิกายน</option>
                        <option value="12">ธันวาคม</option>
                    </select>
                
            </li>
            <li class="nav-item">
                <select class="form-select" name="year" id="year" v-model="year">
                    <option value="2022">2565</option>
                    <option value="2023">2566</option>
                    <option value="2024">2567</option>
                    <option value="2025">2568</option>
                    <option value="2026">2569</option>
                    <option value="2027">2570</option>
                </select>
            </li>
            <li class="nav-item">
            <button type="button" class="btn btn-primary" @click="loadData()">FIND</button>
            </li>
        </ul>
      </section>
    <!-- ======= Services Section ======= -->
    <section id="services" class="services section-bg">
      <div class="container">

        <!-- <div class="section-title">
          <span>เบิกค่าเวร พ.สมทบ</span>
          <h2>เบิกค่าเวร พ.สมทบ</h2>
        </div> -->

        <div class="row">
          <div class="col-lg-6 col-md-6 d-flex align-items-stretch">
            <div class="icon-box w-100 p-3">
              <div class="icon"><i class="bx bx-file"></i></div>
              <table class="table">
                <thead>
                  <td>ลำดับ</td>
                  <td>name</td>
                  <td>เวร(วัน)</td>
                </thead>
                <tbody>
                  <tr v-for="data,index in datas">
                    <td>{{index + 1}}</td>
                    <td class="text-start text-nowrap">{{data.name}}</td>
                    <td>{{ count_arr(data.ven_days)}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="col-lg-6 col-md-6 d-flex align-items-stretch mt-4 mt-md-0">
            <div class="icon-box w-100 p-3">
              <div class="icon"><i class="bx bx-file"></i></div>
              <table class="table">
                <thead>
                  <td>รายการ</td>
                  <td><a href="../../main/web/legal_c_ven/index" target="_blank">โปรแกรมตารางเวรที่ปรึกษา</a></td>
                </thead>
                <tbody class="text-start"> 
                  <tr>
                    <td><a href="./bank/" target="_blank" >ตั้งค่าบัญชีธนาคาร</a></td>
                    <td><a :href="'./report.html?month='+year+'-'+month" target="_blank" >report_การเบิกจ่าย</a></td>
                  </tr>
                    <td></td>
                    <td><a :href="'./report_x1.html?month='+year+'-'+month" target="_blank" >report_หน้างบประกอบการอนุมัติโอนเข้าบัญชี</a></td>
                  <tr>
                  </tr>
                    <td><button @click="gen_word" class="btn btn-primary">สร้างบันทึก</button></td>
                    <td>
                      <a :href="url_link" v-if="url_link" target="_blank" rel="noopener noreferrer">บันทึกขออนุมัติ</a>
                    </td>
                  <tr>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div>

      </div>
    </section><!-- End Services Section --> 

    

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">    

    <div class="container footer-bottom clearfix">
      <div class="copyright">
        &copy; Copyright <strong><span>eNno</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/enno-free-simple-bootstrap-template/ -->
        Designed by <a href="#main">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
  
</div>
  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <!-- <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script> -->
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <!-- <script src="assets/vendor/php-email-form/validate.js"></script> -->

  <!-- Template Main JS File -->
  <script src="../assets/js/main.js"></script>
  <script src="../dist/js/vue.min.js"></script>
  <script src="../dist/js/axios.min.js"></script>
  <script src="..//dist/js/sweetalert2.min.js"></script>
  <script src="./app/index.js"></script>
  <script>
    var url_base = window.location.protocol + '//' + window.location.host;
    var url_base_app = window.location.protocol + '//' + window.location.host + '/fnu/ven_legal/';
    var url_base_now = window.location.href;
    // console.log(url_base_now);

var appMenu = new Vue({
    el: '#app',
    data() {
        return {
            datas: '',            
            month:'',
            year:'',
            url_link:''
        }
    },
    mounted: function() {
        this.getYM();
        this.loadData();
    },
    methods: {
        loadData() {            
            let month = this.year + '-' + this.month
            axios.post(url_base_app + 'api/index/getdata.php',{
                month:month
            })
                .then(response => {
                    // console.log(response.data);
                    if (response.data.status) {
                        this.datas = response.data.datas;
                        // console.log(this.datas);
                        Swal.fire({
                          // position: 'top-end',
                          icon: 'success',
                          title: response.data.massege,
                          showConfirmButton: false,
                          timer: 1500
                        })
                    } else {
                      this.datas = '';
                    }
                })
                .catch(function(error) {

                    // console.log(error);
                    // Toast.fire({
                    //     icon: 'error',
                    //     title: 'เกิดข้อผิดพลาด ' + error
                    // })
                });
        },
        gen_word(){
          let month = this.year + '-' + this.month
            axios.post(url_base_app + 'api/word/gen_word.php',{
                month:month
            })
            .then(response => {
                    // console.log(response.data);
                    if (response.data.status) {
                      this.url_link = response.data.url_link;
                        // this.datas = response.data.datas;
                        // console.log(this.datas);
                        Swal.fire({
                          // position: 'top-end',
                          icon: 'success',
                          title: response.data.massege,
                          showConfirmButton: false,
                          timer: 1500
                        })
                    }
                })
        },
        find(){
            // console.log(this.year + '-' + this.month) ;
        },
        count_arr(data){
          return data.length;
        },
        getYM(){
            let MyDate = new Date();
            let MyDateString;
            // MyDate.setDate(MyDate.getDate() + 20);
            MyDateString = MyDate.getFullYear() + '-' + ("0" + (MyDate.getMonth()+1)).slice(-2);
            this.year = MyDate.getFullYear();
            this.month = ("0" + (MyDate.getMonth()+1)).slice(-2);
            // console.log(MyDateString);
        },
        formatCurrency(number) {
            number = parseFloat(number);
            return number.toFixed(0).replace(/./g, function(c, i, a) {
                return i > 0 && c !== "." && (a.length - i) % 3 === 0 ? "," + c : c;
            });
        },

    },

});
  </script>
</body>

</html>